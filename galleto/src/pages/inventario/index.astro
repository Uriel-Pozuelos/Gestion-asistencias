---
import Layout from '@/layouts/Layout.astro';
import Nav from '@/components/ui/nav.astro';
import {
	Table,
	TableHeader,
	TableBody,
	TableFooter,
	TableHead,
	TableRow,
	TableCell,
	TableCaption
} from '@/components/ui/table';
import { Button } from '@/components/ui/button';
import RadioInventario from '@/components/ui/radiog-inventario';
import { Receipt, CircleDollarSign, Warehouse } from 'lucide-react';
import { navigate } from 'astro:transitions/client';

export interface Inventario {
	id: number;
	nombre: string;
	precio: number;
	stock: number;
}

async function getInventario() {
	const res = await fetch('http://localhost:3001/galletas');
	const inventario = await res.json();
	return inventario as Promise<Inventario[]>;
}

const inventario = await getInventario();
---

<Layout title="Home">
	<Nav />
	<main class="mt-[1rem]">
		<div
			class="container bg-secondary/20 border-secondary rounded-lg p-3 mb-5"
		>
			<div class="grid grid-cols-12">
				<div class="col-start-2 col-span-10">
					<p class="text-[2rem] font-bold text-secondary text-center">
						Inventario
					</p>
				</div>

				<div class="col-start-1 col-span-10">
					<Table>
						<TableHeader>
							<TableRow>
								<TableHead>Galleta</TableHead>
								<TableHead>Cantidad en inventario</TableHead>
								<TableHead>Precio</TableHead>
							</TableRow>
						</TableHeader>
						<TableBody>
							{
								inventario.map(galleta => (
									<TableRow key={galleta.nombre}>
										<TableCell>{galleta.nombre}</TableCell>
										<TableCell>{galleta.stock}</TableCell>
										<TableCell>{galleta.precio}</TableCell>
									</TableRow>
								))
							}
						</TableBody>
					</Table>
				</div>

				<div class="col-start-11 col-span-2 ml-5 flex">
					<div class="row-span-1 my-auto">
						<RadioInventario client:idle />
						<Button className="my-4 w-full ">
							<CircleDollarSign className="me-2" /> Obtener Gasto
						</Button>
						<Button variant={'secondary'} className="w-full">
							<Receipt className="me-2" />Generar recibo
						</Button>
						<a href="/inventario/inventarioProduccion">
							<Button 
								variant={'default'} 
								className='my-4 w-full'
								>
								<Warehouse className='me-2'/> Almac√©n
							</Button>
						</a>
					</div>
				</div>
			</div>
		</div>
	</main>
</Layout>

<!-- Oreo, Plana, Relleno de fresa, Naranja, Relleno de vainilla, Relleno de naranja, Decorada, De helado, De oblea, De chispas -->
